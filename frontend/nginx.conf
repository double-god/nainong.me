server {
    listen 80;
    server_name localhost;

    # 1. 全局根目录 (核心修改：让所有 location 自动继承这个路径)
    root /usr/share/nginx/html;
    index index.html;

    # 2. 必须包含 MIME 类型 (否则 CSS 无法加载)
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # 3. 静态资源缓存 (CSS/JS)
    # 因为上面已经定义了全局 root，这里直接匹配路径即可，无需再写 root/alias
    location /_astro/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # 4. 搜索索引
    location /pagefind/ {
        expires 1d;
        access_log off;
    }

    # 5. SPA 路由兜底
    location / {
        try_files $uri $uri/ /index.html;
    }
}
